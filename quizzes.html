<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Referee Training Quizzes</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f4f6f8; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 800px; margin: 0 auto; }

        /* Navigation */
        .nav-bar { position: relative; display: flex; justify-content: center; align-items: center; margin-bottom: 40px; padding: 10px 0; }
        .nav-center { display: flex; gap: 20px; }
        .nav-link { text-decoration: none; color: #4b5563; font-weight: 600; padding: 8px 16px; border-radius: 6px; font-size: 16px; transition: 0.2s; }
        .nav-link:hover { background-color: #e5e7eb; color: #111827; }
        .nav-link.active { background-color: #2ecc71; color: white; }
        .supervisor-link { position: absolute; right: 0; top: 50%; transform: translateY(-50%); text-decoration: none; color: #2c3e50; font-size: 0.9rem; font-weight: 600; border: 1px solid #d1d5db; padding: 6px 12px; border-radius: 4px; background: white; transition: all 0.2s; }
        .supervisor-link:hover { background: #f3f4f6; border-color: #9ca3af; }
        
        @media (max-width: 800px) {
            .nav-bar { flex-direction: column; gap: 15px; }
            .supervisor-link { position: static; transform: none; margin-left: auto; }
            .nav-center { flex-wrap: wrap; justify-content: center; }
        }

        /* Quiz Styles */
        .card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 30px; }
        h1, h2 { color: #2c3e50; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: 600; }
        input[type="text"], input[type="email"] { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }

        .question-block { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .question-text { font-weight: 600; font-size: 1.1rem; margin-bottom: 10px; }
        
        .option-label { display: block; padding: 8px 10px; border-radius: 6px; cursor: pointer; transition: 0.1s; }
        .option-label:hover { background: #f9f9f9; }
        .option-label input { margin-right: 10px; }

        .btn-submit { background: #2ecc71; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 1rem; font-weight: bold; cursor: pointer; width: 100%; }
        .btn-submit:hover { background: #27ae60; }

        .hidden { display: none; }
        .result-box { text-align: center; padding: 40px; }
        .score-display { font-size: 3rem; font-weight: 800; color: #2ecc71; margin: 20px 0; }
    </style>
</head>
<body>

    <div class="container">
        <div class="nav-bar">
            <div class="nav-center">
                <a href="index.html" class="nav-link">Home</a>
                <a href="report.html" class="nav-link">CMI Form</a>
                <a href="jersey.html" class="nav-link">Kit Search</a>
                <span class="nav-link active">Training Quizzes</span>
            </div>
            <a href="admin.html" class="supervisor-link">ðŸ”’ Supervisors</a>
        </div>

        <div id="intro-card" class="card">
            <h1 style="margin-top:0;">2026 Season Readiness Quiz</h1>
            <p style="color:#666; margin-bottom:25px;">Please enter your details to begin the quiz. Your results will be shared with your supervisor.</p>
            
            <div class="form-group">
                <label>First Name</label>
                <input type="text" id="firstName" required>
            </div>
            <div class="form-group">
                <label>Last Name</label>
                <input type="text" id="lastName" required>
            </div>
            <div class="form-group">
                <label>Email Address</label>
                <input type="email" id="email" required>
            </div>
            <button class="btn-submit" onclick="startQuiz()">Start Quiz</button>
        </div>

        <div id="quiz-card" class="card hidden">
            <h2 style="margin-top:0;">Questions</h2>
            <form id="quizForm">
                
                <div class="question-block" data-correct="B">
                    <div class="question-text">1. On a penalty kick, the kicker plays the ball forward, but a teammate runs into the penalty area before the kick is taken. What is the restart?</div>
                    <label class="option-label"><input type="radio" name="q1" value="A"> Goal Kick</label>
                    <label class="option-label"><input type="radio" name="q1" value="B"> Indirect Free Kick for defense</label>
                    <label class="option-label"><input type="radio" name="q1" value="C"> Retake the Penalty Kick</label>
                </div>

                <div class="question-block" data-correct="A">
                    <div class="question-text">2. A substitute enters the field without permission and interferes with play. The referee stops play. The restart is:</div>
                    <label class="option-label"><input type="radio" name="q2" value="A"> Direct Free Kick / Penalty Kick</label>
                    <label class="option-label"><input type="radio" name="q2" value="B"> Indirect Free Kick</label>
                    <label class="option-label"><input type="radio" name="q2" value="C"> Drop Ball</label>
                </div>

                <div class="question-block" data-correct="C">
                    <div class="question-text">3. The ball is in play when:</div>
                    <label class="option-label"><input type="radio" name="q3" value="A"> It is touched by the kicker</label>
                    <label class="option-label"><input type="radio" name="q3" value="B"> It leaves the center circle</label>
                    <label class="option-label"><input type="radio" name="q3" value="C"> It is kicked and clearly moves</label>
                </div>

                <button type="button" class="btn-submit" onclick="submitQuiz()">Submit Answers</button>
            </form>
        </div>

        <div id="result-card" class="card hidden result-box">
            <h2>Quiz Complete!</h2>
            <p>Your results have been sent to the state office.</p>
            <div class="score-display" id="scoreText">0%</div>
            <button class="btn-submit" onclick="location.reload()" style="background:#3498db; width:auto;">Take Again</button>
        </div>
    </div>

    <script>
        // URL Provided by User
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzi1gJkccUwLsjwPcepY_g9JY6nkLwcOxAn2dAEIw3YNQdWLuBl2lQYf6sOIM2WsRi3Cg/exec";

        function startQuiz() {
            const fName = document.getElementById('firstName').value;
            const lName = document.getElementById('lastName').value;
            const email = document.getElementById('email').value;

            if(!fName || !lName || !email) {
                alert("Please fill out all fields to continue.");
                return;
            }
            document.getElementById('intro-card').classList.add('hidden');
            document.getElementById('quiz-card').classList.remove('hidden');
            window.scrollTo(0,0);
        }

        function submitQuiz() {
            const questions = document.querySelectorAll('.question-block');
            let score = 0;
            let total = questions.length;

            questions.forEach(q => {
                const selected = q.querySelector('input[type="radio"]:checked');
                if (selected && selected.value === q.dataset.correct) {
                    score++;
                }
            });

            const percent = Math.round((score / total) * 100);
            
            // Show Loading State
            const btn = document.querySelector('#quiz-card .btn-submit');
            btn.innerText = "Submitting...";
            btn.disabled = true;

            const payload = {
                type: 'quiz_result', // TELLS BACKEND THIS IS A QUIZ
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                quizName: "2026 Readiness Quiz",
                score: score + "/" + total,
                percent: percent + "%"
            };

            fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify(payload)
            }).then(() => {
                document.getElementById('quiz-card').classList.add('hidden');
                document.getElementById('result-card').classList.remove('hidden');
                document.getElementById('scoreText').innerText = percent + "%";
            }).catch(err => {
                alert("Error submitting results. Please try again.");
                btn.innerText = "Submit Answers";
                btn.disabled = false;
            });
        }
    </script>
</body>
</html>
